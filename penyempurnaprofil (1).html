<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mahamad Oky Muhlisin - Profil Editabel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- ThirdWeb SDK untuk NFT -->
    <script src="https://unpkg.com/@thirdweb-dev/sdk@latest/dist/thirdweb-sdk.browser.min.js"></script>
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2c3e50;
            --light: #f5f7fa;
            --gray: #7f8c8d;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .header h1 {
            color: var(--secondary);
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            color: var(--gray);
            max-width: 600px;
            margin-bottom: 20px;
        }
        
        .control-panel {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 10px 20px;
            border-radius: 30px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-warning {
            background: var(--warning);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .container {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
        }
        
        .editor-panel {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 25px;
            max-height: 95vh;
            overflow-y: auto;
        }
        
        .preview-panel {
            flex: 2;
            min-width: 350px;
        }
        
        .panel-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light);
        }
        
        .panel-title i {
            color: var(--primary);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            font-size: 15px;
        }
        
        .required:after {
            content: " *";
            color: var(--danger);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .btn {
            display: inline-block;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            text-align: center;
        }
        
        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn-save {
            background: var(--success);
            width: 100%;
            padding: 14px;
            font-size: 17px;
        }
        
        .btn-save:hover {
            background: #27ae60;
        }
        
        .btn-reset {
            background: var(--danger);
            width: 100%;
            padding: 14px;
            font-size: 17px;
            margin-top: 15px;
        }
        
        .btn-reset:hover {
            background: #c0392b;
        }
        
        .section-box {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid #eee;
        }
        
        .section-title-box {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .section-title-box h3 {
            font-size: 18px;
            color: var(--dark);
        }
        
        .add-btn {
            background: var(--success);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
        }
        
        .remove-btn {
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            margin-left: 10px;
        }
        
        /* Preview Styles */
        .preview-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .preview-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
        }
        
        .photo-container {
            position: relative;
            width: 150px;
            height: 150px;
            margin: 0 auto 20px;
        }
        
        .profile-photo {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 5px solid rgba(255,255,255,0.3);
            object-fit: cover;
            background: #ddd;
        }
        
        .photo-placeholder {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 5px solid rgba(255,255,255,0.3);
            background: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            color: #a0a0a0;
        }
        
        .preview-header h1 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .preview-content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 1px solid #eee;
        }
        
        .section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--secondary);
            margin-bottom: 20px;
            padding-left: 10px;
            border-left: 4px solid var(--primary);
        }
        
        .info-item {
            margin-bottom: 15px;
            display: flex;
        }
        
        .info-label {
            width: 150px;
            font-weight: 600;
            color: var(--gray);
        }
        
        .info-value {
            flex: 1;
            font-weight: 500;
        }
        
        .links-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .link-item {
            display: block;
            padding: 15px;
            border-radius: 8px;
            background: #f8fafc;
            text-decoration: none;
            color: var(--primary);
            border-left: 3px solid var(--primary);
            transition: all 0.3s;
        }
        
        .link-item:hover {
            background: #e8f4fe;
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .link-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .link-url {
            font-size: 14px;
            color: var(--gray);
            word-break: break-all;
        }
        
        .link-desc {
            font-size: 14px;
            color: #555;
            margin-top: 8px;
        }
        
        .highlight-section {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            padding: 25px;
            color: white;
            text-align: center;
            margin: 25px 0;
        }
        
        .highlight-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 15px;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }
        
        .feature-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            transition: all 0.3s;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
        }
        
        .feature-icon {
            font-size: 36px;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .feature-title {
            font-weight: 700;
            color: var(--secondary);
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .feature-content {
            color: #555;
            line-height: 1.5;
        }
        
        .footer {
            text-align: center;
            color: var(--gray);
            font-size: 14px;
            padding: 20px;
            border-top: 1px solid #eee;
            margin-top: 20px;
        }
        
        .color-picker {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 0 0 2px #ddd;
        }
        
        .color-option.active {
            box-shadow: 0 0 0 2px var(--dark);
        }
        
        .theme-blue { background: linear-gradient(135deg, #3498db, #2c3e50); }
        .theme-green { background: linear-gradient(135deg, #2ecc71, #27ae60); }
        .theme-purple { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
        .theme-orange { background: linear-gradient(135deg, #e67e22, #d35400); }
        .theme-red { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        
        .upload-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            margin-bottom: 15px;
            transition: all 0.3s;
        }
        
        .upload-area:hover {
            border-color: var(--primary);
            background: #f8fafc;
        }
        
        .upload-area i {
            font-size: 40px;
            color: var(--gray);
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .editor-panel, .preview-panel {
                width: 100%;
            }
            
            .header h1 {
                font-size: 24px;
            }
            
            .preview-header h1 {
                font-size: 24px;
            }
        }
        
        /* Tambahan untuk NFT */
        .btn-nft {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
        }
        
        .nft-section {
            margin-top: 30px;
            padding: 20px;
            border-radius: 12px;
            background: #f8f9fa;
            border: 1px solid #eee;
        }
        
        .nft-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }
        
        .nft-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            width: 150px;
            text-align: center;
        }
        
        .nft-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            background: #e0e0e0;
        }
        
        .nft-name {
            padding: 10px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .wallet-info {
            background: #e8f4fe;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1><i class="fas fa-user-edit"></i> Profil Editabel - Komunitas Nyampah Bersama</h1>
        <p class="subtitle">Edit profil, mint NFT, dan bagikan dengan komunitas</p>
        
        <div class="control-panel">
            <button class="control-btn btn-primary" onclick="updatePreview()">
                <i class="fas fa-sync-alt"></i> Perbarui Pratinjau
            </button>
            <button class="control-btn btn-success" onclick="saveData()">
                <i class="fas fa-save"></i> Simpan Profil
            </button>
            <button class="control-btn btn-warning" onclick="downloadPDF()">
                <i class="fas fa-download"></i> Unduh PDF
            </button>
            <button class="control-btn btn-nft" onclick="mintNFT()">
                <i class="fas fa-coins"></i> Mint NFT
            </button>
            <button class="control-btn btn-danger" onclick="resetData()">
                <i class="fas fa-trash-alt"></i> Reset
            </button>
        </div>
    </div>
    
    <div class="container">
        <!-- Editor Panel -->
        <div class="editor-panel">
            <div class="panel-title">
                <i class="fas fa-edit"></i> Editor Profil
            </div>
            
            <div class="form-group">
                <label for="themeSelect" class="required">Pilih Tema Warna</label>
                <div class="color-picker">
                    <div class="color-option theme-blue active" data-theme="blue" onclick="selectTheme('blue')"></div>
                    <div class="color-option theme-green" data-theme="green" onclick="selectTheme('green')"></div>
                    <div class="color-option theme-purple" data-theme="purple" onclick="selectTheme('purple')"></div>
                    <div class="color-option theme-orange" data-theme="orange" onclick="selectTheme('orange')"></div>
                    <div class="color-option theme-red" data-theme="red" onclick="selectTheme('red')"></div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="profilePhoto" class="required">Foto Profil</label>
                <div class="upload-area" onclick="document.getElementById('photoInput').click()">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Klik untuk mengunggah foto</p>
                    <p style="font-size: 12px; color: var(--gray);">Rekomendasi: 300x300px, format JPG/PNG</p>
                </div>
                <input type="file" id="photoInput" accept="image/*" style="display: none;" onchange="previewPhoto(event)">
                <img id="photoPreview" src="" alt="Preview Foto" style="display: none; max-width: 150px; border-radius: 50%; margin-top: 10px;">
            </div>
            
            <div class="form-group">
                <label for="name" class="required"><i class="fas fa-signature"></i> Nama Lengkap</label>
                <input type="text" id="name" placeholder="Masukkan nama lengkap" required>
            </div>
            
            <div class="form-group">
                <label for="title" class="required"><i class="fas fa-briefcase"></i> Jabatan/Posisi</label>
                <input type="text" id="title" placeholder="Mis: Independent Researcher - Teknologi dan Inovasi" required>
            </div>
            
            <div class="form-group">
                <label for="loginId" class="required"><i class="fas fa-id-card"></i> ID Login</label>
                <input type="text" id="loginId" placeholder="EU Login ID" required>
            </div>
            
            <div class="form-group">
                <label for="affiliation"><i class="fas fa-building"></i> Afiliasi</label>
                <input type="text" id="affiliation" placeholder="Organisasi/Institusi">
            </div>
            
            <div class="section-box">
                <div class="section-title-box">
                    <h3><i class="fas fa-link"></i> Tautan Penting</h3>
                    <button class="add-btn" onclick="addLink()">+</button>
                </div>
                
                <div id="links-container">
                    <!-- Link items will be added here -->
                </div>
            </div>
            
            <div class="section-box">
                <div class="section-title-box">
                    <h3><i class="fas fa-users"></i> Komunitas</h3>
                </div>
                
                <div class="form-group">
                    <label for="communityTitle">Judul Komunitas</label>
                    <input type="text" id="communityTitle" placeholder="KOMUNITAS NYAMPAH BERSAMA">
                </div>
                
                <div class="form-group">
                    <label for="communityDesc">Deskripsi Komunitas</label>
                    <textarea id="communityDesc" placeholder="Deskripsi tentang komunitas"></textarea>
                </div>
            </div>
            
            <div class="section-box">
                <div class="section-title-box">
                    <h3><i class="fas fa-star"></i> Fitur dan Aktivitas</h3>
                    <button class="add-btn" onclick="addFeature()">+</button>
                </div>
                
                <div id="features-container">
                    <!-- Feature items will be added here -->
                </div>
            </div>
            
            <button class="btn btn-save" onclick="updatePreview()">
                <i class="fas fa-sync-alt"></i> Perbarui Pratinjau
            </button>
            
            <button class="btn btn-reset" onclick="resetData()">
                <i class="fas fa-trash-alt"></i> Reset Semua Data
            </button>
        </div>
        
        
            <!-- Bagian NFT -->
            <div class="nft-section">
                <div class="section-title-box">
                    <h3><i class="fas fa-coins"></i> NFT Settings</h3>
                </div>
                
                <div class="form-group">
                    <label for="nftCollection"><i class="fas fa-cube"></i> NFT Collection Address</label>
                    <input type="text" id="nftCollection" value="0xFC7C4E1dc5478332516552E00b54494945e41Ccd" readonly>
                </div>
                
                <div class="form-group">
                    <label for="nftMetadata"><i class="fas fa-info-circle"></i> NFT Metadata</label>
                    <textarea id="nftMetadata" placeholder="Deskripsi NFT">Profil anggota Komunitas Nyampah Bersama</textarea>
                </div>
                
                <button class="btn btn-nft" onclick="connectWallet()">
                    <i class="fas fa-wallet"></i> Connect Wallet
                </button>
                
                <div id="walletInfo" class="wallet-info" style="display: none;">
                    <i class="fas fa-wallet"></i> Wallet Connected: 
                    <span id="walletAddress"></span>
                </div>
            </div>
            
            
            <!-- ... (Tombol lainnya tetap sama) ... -->
        </div>
        
        <!-- Preview Panel -->
        <div class="preview-panel">
            <div class="panel-title">
                <i class="fas fa-eye"></i> Pratinjau Profil
            </div>
            
            <div class="preview-card" id="preview-card">
                <!-- ... (Preview sebelumnya tetap sama) ... -->
                
                <!-- Bagian NFT di Preview -->
                <div class="section">
                    <div class="section-title">NFT Saya</div>
                    <div class="nft-container" id="preview-nfts">
                        <!-- NFT akan ditampilkan di sini -->
                    </div>
                </div>
                
                <!-- ... (Footer tetap sama) ... -->
            </div>
        </div>
    </div>
            
        
        <!-- Preview Panel -->
        <div class="preview-panel">
            <div class="panel-title">
                <i class="fas fa-eye"></i> Pratinjau Profil
            </div>
            
            <div class="preview-card" id="preview-card">
                <div class="preview-header" id="preview-header">
                    <div class="photo-container">
                        <div class="photo-placeholder" id="photoPlaceholder">
                            <i class="fas fa-user"></i>
                        </div>
                        <img class="profile-photo" id="previewPhoto" src="" alt="Foto Profil" style="display: none;">
                    </div>
                    <h1 id="preview-name">Mahamad Oky Muhlisin</h1>
                    <p id="preview-title">Independent Researcher — Teknologi dan Inovasi—</p>
                </div>
                
                <div class="preview-content">
                    <div class="section">
                        <div class="section-title">Profil</div>
                        
                        <div class="info-item">
                            <div class="info-label">Nama Lengkap</div>
                            <div class="info-value" id="preview-name2">Mahamad Oky Muhlisin</div>
                        </div>
                        
                        <div class="info-item">
                            <div class="info-label">ID Login</div>
                            <div class="info-value" id="preview-loginId">n00jccbv</div>
                        </div>
                        
                        <div class="info-item">
                            <div class="info-label">Afiliasi</div>
                            <div class="info-value" id="preview-affiliation">Independent Researcher — Teknologi dan Inovasi—</div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Tautan Penting</div>
                        
                        <div class="links-container" id="preview-links">
                            <!-- Preview links will be added here -->
                        </div>
                    </div>
                    
                    <div class="highlight-section" id="community-section">
                        <div class="highlight-title" id="preview-community-title">KOMUNITAS NYAMPAH BERSAMA</div>
                        <div id="preview-community-desc">Temukan bagaimana Komunitas Nyampah Bersama menyelesaikan masalah nyata</div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Fitur dan Aktivitas</div>
                        
                        <div class="features" id="preview-features">
                            <!-- Preview features will be added here -->
                        </div>
                    </div>
                </div>
                
                <div class="footer">
                    &copy; 2025 Komunitas Nyampah Bersama | Inovasi untuk Masa Depan Berkelanjutan
                </div>
            </div>
        </div>
    </div>

    <script>
        // Theme colors
        const themes = {
            blue: { primary: '#3498db', secondary: '#2c3e50' },
            green: { primary: '#2ecc71', secondary: '#27ae60' },
            purple: { primary: '#9b59b6', secondary: '#8e44ad' },
            orange: { primary: '#e67e22', secondary: '#d35400' },
            red: { primary: '#e74c3c', secondary: '#c0392b' }
        };
        
        // Current theme
        let currentTheme = 'blue';
        
        // Initialize the page
        function init() {
            // Load saved data
            loadData();
            
            // Initialize links and features
            initLinks();
            initFeatures();
            
            // Set initial preview
            updatePreview();
        }
        
        // Select theme
        function selectTheme(theme) {
            currentTheme = theme;
            
            // Update active state
            document.querySelectorAll('.color-option').forEach(option => {
                option.classList.remove('active');
            });
            document.querySelector(`.color-option[data-theme="${theme}"]`).classList.add('active');
            
            // Update preview
            updatePreview();
        }
        
        // Preview uploaded photo
        function previewPhoto(event) {
            const reader = new FileReader();
            reader.onload = function() {
                const preview = document.getElementById('photoPreview');
                preview.src = reader.result;
                preview.style.display = 'block';
            }
            if(event.target.files.length > 0) {
                reader.readAsDataURL(event.target.files[0]);
            }
        }
        
        // Add a new link field
        function addLink() {
            const linksContainer = document.getElementById('links-container');
            const linkCount = linksContainer.children.length + 1;
            
            const linkHtml = `
                <div class="section-box link-item" data-id="${linkCount}">
                    <div class="section-title-box">
                        <h3>Tautan ${linkCount}</h3>
                        <button class="remove-btn" onclick="removeItem(this, 'link')">×</button>
                    </div>
                    <div class="form-group">
                        <label for="link${linkCount}Title">Judul Tautan</label>
                        <input type="text" id="link${linkCount}Title" placeholder="Mis: OECD">
                    </div>
                    <div class="form-group">
                        <label for="link${linkCount}Url">URL Tautan</label>
                        <input type="text" id="link${linkCount}Url" placeholder="https://">
                    </div>
                    <div class="form-group">
                        <label for="link${linkCount}Desc">Deskripsi Tautan</label>
                        <textarea id="link${linkCount}Desc" placeholder="Deskripsi singkat"></textarea>
                    </div>
                </div>
            `;
            
            linksContainer.insertAdjacentHTML('beforeend', linkHtml);
        }
        
        // Add a new feature field
        function addFeature() {
            const featuresContainer = document.getElementById('features-container');
            const featureCount = featuresContainer.children.length + 1;
            
            const featureHtml = `
                <div class="section-box feature-item" data-id="${featureCount}">
                    <div class="section-title-box">
                        <h3>Fitur ${featureCount}</h3>
                        <button class="remove-btn" onclick="removeItem(this, 'feature')">×</button>
                    </div>
                    <div class="form-group">
                        <label for="feature${featureCount}Title">Judul Fitur</label>
                        <input type="text" id="feature${featureCount}Title" placeholder="Mis: Selamat Datang">
                    </div>
                    <div class="form-group">
                        <label for="feature${featureCount}Desc">Deskripsi Fitur</label>
                        <textarea id="feature${featureCount}Desc" placeholder="Deskripsi fitur" rows="3"></textarea>
                    </div>
                </div>
            `;
            
            featuresContainer.insertAdjacentHTML('beforeend', featureHtml);
        }
        
        // Remove an item (link or feature)
        function removeItem(element, type) {
            const item = element.closest('.section-box');
            item.remove();
            
            // Renumber remaining items
            if(type === 'link') {
                renumberItems('link');
            } else {
                renumberItems('feature');
            }
        }
        
        // Renumber items after removal
        function renumberItems(type) {
            const container = type === 'link' ? 
                document.getElementById('links-container') : 
                document.getElementById('features-container');
            
            const items = container.querySelectorAll('.section-box');
            items.forEach((item, index) => {
                const newId = index + 1;
                item.setAttribute('data-id', newId);
                item.querySelector('h3').textContent = `${type === 'link' ? 'Tautan' : 'Fitur'} ${newId}`;
                
                // Update input IDs
                const inputs = item.querySelectorAll('input, textarea');
                inputs.forEach(input => {
                    const id = input.id;
                    const newId = id.replace(/\d+/, newId);
                    input.id = newId;
                });
            });
        }
        
        // Initialize with 2 links
        function initLinks() {
            const linksContainer = document.getElementById('links-container');
            linksContainer.innerHTML = '';
            
            for(let i = 1; i <= 2; i++) {
                const linkHtml = `
                    <div class="section-box link-item" data-id="${i}">
                        <div class="section-title-box">
                            <h3>Tautan ${i}</h3>
                            <button class="remove-btn" onclick="removeItem(this, 'link')">×</button>
                        </div>
                        <div class="form-group">
                            <label for="link${i}Title">Judul Tautan</label>
                            <input type="text" id="link${i}Title" placeholder="Mis: OECD">
                        </div>
                        <div class="form-group">
                            <label for="link${i}Url">URL Tautan</label>
                            <input type="text" id="link${i}Url" placeholder="https://">
                        </div>
                        <div class="form-group">
                            <label for="link${i}Desc">Deskripsi Tautan</label>
                            <textarea id="link${i}Desc" placeholder="Deskripsi singkat"></textarea>
                        </div>
                    </div>
                `;
                
                linksContainer.insertAdjacentHTML('beforeend', linkHtml);
            }
        }
        
        // Initialize with 2 features
        function initFeatures() {
            const featuresContainer = document.getElementById('features-container');
            featuresContainer.innerHTML = '';
            
            for(let i = 1; i <= 2; i++) {
                const featureHtml = `
                    <div class="section-box feature-item" data-id="${i}">
                        <div class="section-title-box">
                            <h3>Fitur ${i}</h3>
                            <button class="remove-btn" onclick="removeItem(this, 'feature')">×</button>
                        </div>
                        <div class="form-group">
                            <label for="feature${i}Title">Judul Fitur</label>
                            <input type="text" id="feature${i}Title" placeholder="Mis: Selamat Datang">
                        </div>
                        <div class="form-group">
                            <label for="feature${i}Desc">Deskripsi Fitur</label>
                            <textarea id="feature${i}Desc" placeholder="Deskripsi fitur" rows="3"></textarea>
                        </div>
                    </div>
                `;
                
                featuresContainer.insertAdjacentHTML('beforeend', featureHtml);
            }
        }
        
        // Save data to localStorage
        function saveData() {
            const profileData = {
                theme: currentTheme,
                name: document.getElementById('name').value,
                title: document.getElementById('title').value,
                loginId: document.getElementById('loginId').value,
                affiliation: document.getElementById('affiliation').value,
                communityTitle: document.getElementById('communityTitle').value,
                communityDesc: document.getElementById('communityDesc').value,
                photo: document.getElementById('photoPreview').src,
                links: [],
                features: []
            };
            
            // Save links
            const linkItems = document.querySelectorAll('.link-item');
            linkItems.forEach(item => {
                const id = item.getAttribute('data-id');
                profileData.links.push({
                    title: document.getElementById(`link${id}Title`).value,
                    url: document.getElementById(`link${id}Url`).value,
                    desc: document.getElementById(`link${id}Desc`).value
                });
            });
            
            // Save features
            const featureItems = document.querySelectorAll('.feature-item');
            featureItems.forEach(item => {
                const id = item.getAttribute('data-id');
                profileData.features.push({
                    title: document.getElementById(`feature${id}Title`).value,
                    desc: document.getElementById(`feature${id}Desc`).value
                });
            });
            
            // Save to localStorage
            localStorage.setItem('profileData', JSON.stringify(profileData));
            
            alert('Data berhasil disimpan!');
        }
        
        // Load data from localStorage
        function loadData() {
            const savedData = localStorage.getItem('profileData');
            if(savedData) {
                const profileData = JSON.parse(savedData);
                
                // Set theme
                selectTheme(profileData.theme || 'blue');
                
                // Set basic fields
                document.getElementById('name').value = profileData.name || '';
                document.getElementById('title').value = profileData.title || '';
                document.getElementById('loginId').value = profileData.loginId || '';
                document.getElementById('affiliation').value = profileData.affiliation || '';
                document.getElementById('communityTitle').value = profileData.communityTitle || '';
                document.getElementById('communityDesc').value = profileData.communityDesc || '';
                
                // Set photo
                if(profileData.photo) {
                    document.getElementById('photoPreview').src = profileData.photo;
                    document.getElementById('photoPreview').style.display = 'block';
                }
                
                // Set links
                if(profileData.links && profileData.links.length > 0) {
                    initLinks();
                    profileData.links.forEach((link, index) => {
                        const id = index + 1;
                        if(document.getElementById(`link${id}Title`)) {
                            document.getElementById(`link${id}Title`).value = link.title || '';
                            document.getElementById(`link${id}Url`).value = link.url || '';
                            document.getElementById(`link${id}Desc`).value = link.desc || '';
                        }
                    });
                }
                
                // Set features
                if(profileData.features && profileData.features.length > 0) {
                    initFeatures();
                    profileData.features.forEach((feature, index) => {
                        const id = index + 1;
                        if(document.getElementById(`feature${id}Title`)) {
                            document.getElementById(`feature${id}Title`).value = feature.title || '';
                            document.getElementById(`feature${id}Desc`).value = feature.desc || '';
                        }
                    });
                }
            } else {
                // Set default values
                document.getElementById('name').value = 'Mahamad Oky Muhlisin';
                document.getElementById('title').value = 'Independent Researcher — Teknologi dan Inovasi—';
                document.getElementById('loginId').value = 'n00jccbv';
                document.getElementById('affiliation').value = 'Independent Researcher — Teknologi dan Inovasi—';
                document.getElementById('link1Title').value = 'OECD';
                document.getElementById('link1Url').value = 'https://uedd.org/0009-0009-';
                document.getElementById('link1Desc').value = 'Mahamad Oky Muhlisin - Profil Peneliti';
                document.getElementById('link2Title').value = 'Profil Lengkap';
                document.getElementById('link2Url').value = 'https://independent.sendomi...';
                document.getElementById('link2Desc').value = 'Mahamad Oky Muhlisin adalah peneliti independent yang berdedikasi';
                document.getElementById('communityTitle').value = 'KOMUNITAS NYAMPAH BERSAMA';
                document.getElementById('communityDesc').value = 'Temukan bagaimana Komunitas Nyampah Bersama menyelesaikan masalah nyata';
                document.getElementById('feature1Title').value = 'Selamat Datang';
                document.getElementById('feature1Desc').value = 'Komunitas Nyampah Bersama\nSistem Bank Sampah untuk';
                document.getElementById('feature2Title').value = 'KOMUNITAS NYAMPAH BERSAMA';
                document.getElementById('feature2Desc').value = 'E-Vehicle Bersama\nAkademi Nyampah Bersama';
            }
        }
        
        // Reset all data
        function resetData() {
            if(confirm('Apakah Anda yakin ingin menghapus semua data?')) {
                localStorage.removeItem('profileData');
                location.reload();
            }
        }
        
        // Update preview
        function updatePreview() {
            // Validate required fields
            const name = document.getElementById('name').value;
            if (!name.trim()) {
                alert('Nama tidak boleh kosong!');
                return;
            }
            
            // Update theme
            const theme = themes[currentTheme];
            document.documentElement.style.setProperty('--primary', theme.primary);
            document.documentElement.style.setProperty('--secondary', theme.secondary);
            
            // Update profile information
            document.getElementById('preview-name').textContent = name;
            document.getElementById('preview-title').textContent = document.getElementById('title').value;
            document.getElementById('preview-name2').textContent = name;
            document.getElementById('preview-loginId').textContent = document.getElementById('loginId').value;
            document.getElementById('preview-affiliation').textContent = document.getElementById('affiliation').value;
            
            // Update photo
            const photoPreview = document.getElementById('photoPreview');
            if(photoPreview.src && photoPreview.style.display === 'block') {
                document.getElementById('previewPhoto').src = photoPreview.src;
                document.getElementById('previewPhoto').style.display = 'block';
                document.getElementById('photoPlaceholder').style.display = 'none';
            } else {
                document.getElementById('previewPhoto').style.display = 'none';
                document.getElementById('photoPlaceholder').style.display = 'flex';
            }
            
            // Update community section
            document.getElementById('preview-community-title').textContent = document.getElementById('communityTitle').value;
            document.getElementById('preview-community-desc').textContent = document.getElementById('communityDesc').value;
            
            // Update links
            const previewLinks = document.getElementById('preview-links');
            previewLinks.innerHTML = '';
            
            const linkItems = document.querySelectorAll('.link-item');
            linkItems.forEach(item => {
                const id = item.getAttribute('data-id');
                const title = document.getElementById(`link${id}Title`).value;
                const url = document.getElementById(`link${id}Url`).value;
                const desc = document.getElementById(`link${id}Desc`).value;
                
                if(title || url || desc) {
                    const linkHtml = `
                        <a href="${url}" class="link-item" target="_blank">
                            <div class="link-title">${title || 'Tautan Tanpa Judul'}</div>
                            <div class="link-url">${url || 'URL tidak tersedia'}</div>
                            <div class="link-desc">${desc || 'Tidak ada deskripsi'}</div>
                        </a>
                    `;
                    previewLinks.insertAdjacentHTML('beforeend', linkHtml);
                }
            });
            
            // Update features
            const previewFeatures = document.getElementById('preview-features');
            previewFeatures.innerHTML = '';
            
            const featureItems = document.querySelectorAll('.feature-item');
            featureItems.forEach((item, index) => {
                const id = item.getAttribute('data-id');
                const title = document.getElementById(`feature${id}Title`).value;
                const desc = document.getElementById(`feature${id}Desc`).value;
                
                if(title || desc) {
                    const icons = ['fa-seedling', 'fa-recycle', 'fa-tree', 'fa-leaf', 'fa-globe'];
                    const icon = icons[index] || 'fa-star';
                    
                    const featureHtml = `
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas ${icon}"></i>
                            </div>
                            <div class="feature-title">${title || 'Fitur Tanpa Judul'}</div>
                            <div class="feature-content">
                                ${desc.replace(/\n/g, '<br>') || 'Tidak ada deskripsi'}
                            </div>
                        </div>
                    `;
                    previewFeatures.insertAdjacentHTML('beforeend', featureHtml);
                }
            });
            
            // Show success message
            alert('Pratinjau berhasil diperbarui!');
        }
        
        // Download as PDF
        function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            const card = document.getElementById('preview-card');
            
            html2canvas(card, { 
                scale: 2,
                useCORS: true,
                logging: false
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/jpeg', 0.95);
                const imgWidth = doc.internal.pageSize.getWidth();
                const imgHeight = canvas.height * imgWidth / canvas.width;
                
                doc.addImage(imgData, 'JPEG', 0, 0, imgWidth, imgHeight);
                doc.save('profil_komunitas_nyampah_bersama.pdf');
            });
        }
        
        // Variabel untuk wallet dan NFT
        let walletAddress = null;
        let sdk = null;
        let nftContract = null;
        
        // Inisialisasi ThirdWeb SDK
        async function initNFT() {
            try {
                // Gunakan Base mainnet (chain ID 8453)
                sdk = new ThirdwebSDK.ThirdwebSDK("base");
                nftContract = await sdk.getContract("0xFC7C4E1dc5478332516552E00b54494945e41Ccd");
                console.log("NFT Contract initialized:", nftContract);
                
                // Jika wallet sudah terhubung, muat NFT
                if (walletAddress) {
                    loadNFTs();
                }
            } catch (error) {
                console.error("Error initializing NFT contract:", error);
                alert("Gagal menginisialisasi kontrak NFT: " + error.message);
            }
        }
        
        // Hubungkan wallet pengguna
        async function connectWallet() {
            try {
                // Cek apakah MetaMask terpasang
                if (!window.ethereum) {
                    alert("Silakan instal MetaMask terlebih dahulu!");
                    return;
                }
                
                // Minta koneksi wallet
                const accounts = await window.ethereum.request({ 
                    method: "eth_requestAccounts" 
                });
                
                walletAddress = accounts[0];
                document.getElementById("walletInfo").style.display = "block";
                document.getElementById("walletAddress").textContent = 
                    walletAddress.substring(0, 6) + "..." + walletAddress.substring(walletAddress.length - 4);
                
                alert("Wallet berhasil terhubung!");
                
                // Inisialisasi kontrak NFT jika belum
                if (!nftContract) {
                    await initNFT();
                }
                
                // Muat NFT pengguna
                loadNFTs();
            } catch (error) {
                console.error("Error connecting wallet:", error);
                alert("Gagal menghubungkan wallet: " + error.message);
            }
        }
        
        // Mint NFT baru
        async function mintNFT() {
            try {
                if (!walletAddress) {
                    alert("Silakan hubungkan wallet terlebih dahulu!");
                    return;
                }
                
                // Dapatkan data dari form
                const name = document.getElementById('name').value || "Anggota Komunitas";
                const metadata = document.getElementById('nftMetadata').value;
                let image = document.getElementById('photoPreview').src;
                
                // Jika tidak ada foto, gunakan placeholder
                if (!image) {
                    image = "https://via.placeholder.com/300?text=No+Photo";
                }
                
                // Buat metadata NFT
                const nftMetadata = {
                    name: name,
                    description: metadata,
                    image: image,
                    properties: {
                        komunitas: "Nyampah Bersama",
                        tanggal: new Date().toLocaleDateString()
                    }
                };
                
                // Mint NFT
                alert("Memproses mint NFT... Harap konfirmasi transaksi di wallet Anda.");
                const tx = await nftContract.erc721.mintTo(walletAddress, nftMetadata);
                
                alert(`NFT berhasil di-mint! TX Hash: ${tx.id}`);
                console.log("NFT minted:", tx);
                
                // Muat ulang NFT
                loadNFTs();
                
                // Perbarui preview
                updatePreview();
            } catch (error) {
                console.error("Error minting NFT:", error);
                alert("Gagal mint NFT: " + error.message);
            }
        }
        
        // Muat NFT pengguna
        async function loadNFTs() {
            try {
                if (!walletAddress || !nftContract) return;
                
                // Dapatkan semua NFT milik pengguna
                const nfts = await nftContract.getOwned(walletAddress);
                console.log("User NFTs:", nfts);
                
                // Tampilkan di preview
                const nftContainer = document.getElementById("preview-nfts");
                nftContainer.innerHTML = "";
                
                if (nfts.length === 0) {
                    nftContainer.innerHTML = "<p>Anda belum memiliki NFT dari koleksi ini</p>";
                    return;
                }
                
                nfts.forEach(nft => {
                    const nftCard = document.createElement("div");
                    nftCard.className = "nft-card";
                    nftCard.innerHTML = `
                        <img class="nft-image" src="${nft.metadata.image}" alt="${nft.metadata.name}">
                        <div class="nft-name">${nft.metadata.name}</div>
                    `;
                    nftContainer.appendChild(nftCard);
                });
            } catch (error) {
                console.error("Error loading NFTs:", error);
            }
        }
        
        // Inisialisasi halaman
        function init() {
            // ... (Inisialisasi sebelumnya) ...
            
            // Inisialisasi NFT
            initNFT();
        }
        
        // ... (Fungsi lainnya tetap sama) ...
        
        // Perbarui preview untuk menampilkan NFT
        function updatePreview() {
            // ... (Kode sebelumnya) ...
            
            // Perbarui tampilan NFT
            if (walletAddress && nftContract) {
                loadNFTs();
            }
        }
        
        // Inisialisasi halaman
        init();
    </script>
</body>
</html>